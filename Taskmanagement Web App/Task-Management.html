<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Task Manager</title>
  <link rel="stylesheet" href="styles.css">
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <style>
  </style>
</head>
<body>
  <div id="container">
    <div id="taskOperation">
        <div class="addCon" id="addCon">
            <div id="ProjectInfo">
                <H1>Enter The basic details of your project.</H1>
                <div><label for="Name">Project Name</label>
                    <input type="text" name="Name" class="PRinput" id="PRname" placeholder="Name"></div>
                <div>
                    <label for="Description">Project Description</label>
                    <Textarea class="PRinput" id="PRdes" placeholder="Description"></Textarea>
                </div>
                <input type="button" id="CreateButton" value="Create Project">
            </div>
    
        </div>
    </div>
    <div class="Adder"><button id="addButton" onclick="popup()">+</button></div>
    <div id="box1">
        <div id="info">
            <h1>Hi Anshul</h1>
        <h5>Welcome back to the workspace, we missed You!</h5>
        <input type="text" class="search" placeholder="Search Task or Projet..">
        </div>
        <h3>Projects <span id="totalProjects">(13)</span></h3>
        <div id="grid-list">
    </div></div>
    <div id="box2">
        <h1 id="projectName">Project Name</h1>
        <h5 id="projectDescription">Please select any project and if there is no project create one.</h5>
        <div id="today"><h3>Today</h3>
            <select name="operation" id="operation" onchange="Operation('operation')">
                <option value="0">...</option>
                <option class="Add" value="Add">Add</option>
                <option class="Edit" value="Edit">Edit</option>
                <option class="Delete" value="Delete">Delete</option>
            </select>
    </div>
    <hr>
        <div class="todayTask" id="TodayTask">
            <div class="alignment">
                <div>
                    <i class='bx bx-list-ul list'></i>
                    <h5>Creating initial UI for page</h5></div>
                    <input type="button" value="Approved" class="indicators-approved">
                </div>
                <div class="alignment">
                    <div>
                        <i class='bx bx-list-ul list'></i>
                        <h5>Start Working on that UI</h5></div>
                        <input type="button" value="In-Waiting" class="indicators-waiting">
                    </div>
                    
                    
                </div>
                <div id="upcoming"><h3>Upcoming</h3>
                    <select name="operation" id="upcomingOperation" onchange="Operation('upcomingOperation')">
                        <option value="0">. . .</option>
                        <option class="Add" value="Add">Add</option>
                        <option class="Edit" value="Edit">Edit</option>
                        <option class="Delete" value="Delete">Delete</option>
                    </select>
                </div>
                <hr>
                <div class="todayTask" id="upcomingTask">
                <div class="alignment">
                    <div>
                    <i class='bx bx-list-ul list'></i>
                    <h5>Writing CSS For Tha Page</h5></div>
                    <input type="button" value="In-Waiting" class="indicators-waiting">
                </div>
                <div class="alignment">
                    <div>
                        <i class='bx bx-list-ul list'></i>
                        <h5>wRITING Javascript For That Page</h5></div>
                        <input type="button" value="In-Waiting" class="indicators-waiting">
                    </div>
                    <div class="alignment">
                        <div>
                            <i class='bx bx-list-ul list'></i>
                    <h5>Finishing With Final Touches</h5></div>
                    <input type="button" value="In-Waiting" class="indicators-waiting">
                </div>
        </div>
    </div>
  </div>    
  <script>
    var addCon = document.getElementById('addCon');
    var PRdes = document.getElementById("PRdes");
    var PRname = document.getElementById("PRname");
    var CreateButton = document.getElementById("CreateButton");
    var gridList = document.getElementById("grid-list") 
    var taskInfo = document.getElementsByClassName('task-info')
    const divs = document.querySelectorAll('.task-info');
    var projectName = document.getElementById('projectName');
    var projectDescription = document.getElementById('projectDescription');
    var TodayTask = document.getElementById("TodayTask");
    var upcomingTask = document.getElementById("upcomingTask");
    var option = document.getElementById('option');
    var select = document.getElementsByTagName('select');
    var addButton = document.getElementById('addButton');
    var taskOperation = document.getElementById('taskOperation');
    var show = 0;
    var selectedProject = '';
    var colors = [
    "linear-gradient(rgb(190, 255, 190) , rgb(17, 218, 94))",
    "linear-gradient(rgb(190, 250, 255) , rgb(17, 195, 218))",
    "linear-gradient(rgb(237, 255, 190) , rgb(191, 218, 17))",
        "linear-gradient(rgb(255, 190, 190) , rgb(218, 84, 17))",
        "linear-gradient(rgb(255, 190, 232) , rgb(218, 17, 188))",
        "linear-gradient(rgb(203, 190, 255) , rgb(158, 17, 218))",
    ]
    

    function popup(){
        if (show === 0){
            addCon.classList.add('addConPopUp');
            taskOperation.style.opacity = 100;
            taskOperation.style.visibility = 'visible';
            
            addButton.innerText = 'x';
            show++;
        }
        else{
            taskOperation.style.opacity = 0;
            taskOperation.style.visibility = 'hidden';
            addCon.classList.remove('addConPopUp');
            addButton.innerText = '+';
            show--;
        }
    }
    if(!localStorage.ProjectId){
        localStorage.ProjectId = '0';
    }
    else{
    }
    updateProjectList();

    //Working Of Select Tag
    function Operation(selectID) {
        var selectElement = document.getElementById(selectID)

        if(selectElement.value === 'Add'){
        var Alignment = document.createElement('div');
        Alignment.className = 'alignment';
        var Div = document.createElement('div');
        var InputTask = document.createElement('input');
        InputTask.id = 'TaskInput';
        InputTask.placeholder = "Enter Task"
        var btn = document.createElement('input');
        btn.type = "button";
        btn.id = "TaskCreator";
        btn.value = "Done";
        btn.addEventListener("click",e=>AddTask());
        var Indicator = document.createElement('select');
        Indicator.id = 'IndicatorSelecter';
        Indicator.innerHTML = '<option value="indicators-approved">Approved</option><option value="indicators-inprogress">In-Progress</option><option value="indicators-waiting">In-Waiting</option>'
        Div.appendChild(InputTask);
        Alignment.appendChild(Div);
        Alignment.appendChild(Indicator);
        Alignment.appendChild(btn)
        if(selectElement.id === "operation"){
            TodayTask.appendChild(Alignment);
        }
        else{
            upcomingTask.appendChild(Alignment);
        }
        }
        
        selectElement.selectedIndex = 0;
    }


    //Create Task And Add it
    function AddTask(){
        var TaskInput = document.getElementById('TaskInput');
        var IndicatorSelecter = document.getElementById('IndicatorSelecter');
        var ProjectTodayTasks = {"projectId":selectedProject,"todayTask":{'task':[TaskInput.value],'indicator':[IndicatorSelecter.value]}}
        var Tasks = [];
        Tasks.push(ProjectTodayTasks);
        var StringJson = JSON.stringify(Tasks);
        if(localStorage.TodayProjectsTasks){
            var checkId = JSON.parse(localStorage.TodayProjectsTasks);
            checkId.forEach((element)=>{
                if(element.projectId===selectedProject){
                    element.todayTask.task.push(ProjectTodayTasks.todayTask.task[0]);
                    element.todayTask.indicator.push(ProjectTodayTasks.todayTask.indicator[0]);
                    localStorage.TodayProjectsTasks = JSON.stringify(checkId);
                }
                else{
                    localStorage.TodayProjectsTasks +=StringJson;
                    var LocalString = localStorage.TodayProjectsTasks;
                    var CorrectString = LocalString.replace("][",",");
                    localStorage.TodayProjectsTasks = CorrectString;
                }
            })
            console.log(checkId);
        }
        else{
            localStorage.TodayProjectsTasks = StringJson;
            console.log(localStorage.TodayProjectsTasks);   
        }
        updateTodayTasks();
    }

    //It creates and shows how many projects we have .
    CreateButton.addEventListener("click",()=>{
        var a = {};
        var projectList = [];
        var strProjects = "";
        var jsonString = "";
        a = {'name':PRname.value,'description':PRdes.value,'ProjectId':localStorage.ProjectId};
        projectList.push(a);
        localStorage.ProjectId++;
        if(localStorage.projects){
            localStorage.projects += JSON.stringify(projectList);
            jsonString = localStorage.projects
            strProjects = jsonString.replace('][', ',');
            localStorage.projects = strProjects;
            taskOperation.style.opacity = 0;
            taskOperation.style.visibility = 'hidden';
            addCon.classList.remove('addConPopUp');
            addButton.innerText = '+';
            show--;
        }
        else{
            localStorage.projects = JSON.stringify(projectList);
            taskOperation.style.opacity = 0;
            taskOperation.style.visibility = 'hidden';
            addCon.classList.remove('addConPopUp');
            addButton.innerText = '+';
            show--;
        }
        updateProjectList();
    });



    function updateProjectList(){
        var totalProjects = document.getElementById('totalProjects');
        gridList.innerHTML = "";
        var colorIndex = 0;
        if (localStorage.projects){
            var parseProjects = [];
            parseProjects = JSON.parse(localStorage.projects);
            totalProjects.innerHTML = `(${parseProjects.length})`;
            parseProjects.forEach((project,index)=>{
                if(index>=6){
                    var AllTask = document.querySelectorAll('.task-info');
                    var last = AllTask.item(AllTask.length-1)
                    last.innerHTML = "";
                    var taskInfo = document.createElement('div');
                taskInfo.className = 'task-info';
                var taskImg = document.createElement('div');
                taskImg.className = 'taskImg';
                    taskImg.style.background = colors[colorIndex];
                    taskImg.innerHTML = `${parseProjects.length-5}+`;
                var Name = document.createElement('span');
                Name.innerText = `MORE`;
                last.appendChild(taskImg);
                last.appendChild(Name);


                }
                else{
                var taskInfo = document.createElement('div');
                taskInfo.className = 'task-info';
                var taskImg = document.createElement('div');
                taskImg.className = 'taskImg';
               if(colorIndex <=5){
                   taskImg.style.background = colors[colorIndex];
                   colorIndex++
            } 
            else{
                    colorIndex = 0;
                    taskImg.style.background = colors[colorIndex];

               }
               var shortName = project.name.split(" ");
               shortName.forEach((element)=>{
                taskImg.innerHTML += element[0];
               })
               taskImg.innerHTML
                var Name = document.createElement('span');
                Name.innerText = `${project.name}`;
                taskInfo.appendChild(taskImg);
                taskInfo.appendChild(Name);
                taskInfo.addEventListener("click",()=>{
                    projectName.innerText = project.name;
                    projectDescription.innerText = project.description;
                    Selected(project.ProjectId);
                })
                gridList.appendChild(taskInfo);
                }
            })
        }
        else{
            gridList.innerHTML = "No Projects Yet";

        }
    }


    //Selected Function to know which function is going to be selected.....
    function Selected(prId){
        selectedProject = prId;
        console.log(selectedProject)
        var Alignment = document.createElement('div');
        Alignment.className = 'alignment';
        var Div = document.createElement('div');
        var Itag = document.createElement('i');
        Itag.className = 'bx bx-list-ul list';
        var H5 = document.createElement('h5');
        var Input = document.createElement('input');
        Input.className = 'indicators-waiting';
        Input.type = 'button';
        Div.appendChild(Itag);
        Div.appendChild(H5);
        Alignment.appendChild(Div);
        Alignment.appendChild(Input);
        TodayTask.appendChild(Alignment);
    }
    function updateTodayTasks(){
        if(selectedProject===""){
            
        }
        else{
            var AllTodayTasks = JSON.parse(localStorage.TodayProjectsTasks);
        AllTodayTasks.forEach((element)=>{
            if(element.projectId === selectedProject){
                TodayTask.innerHTML = "";
                console.log(element.todayTask)
                element.todayTask.task.forEach((task,index)=>{
                    var Alignment = document.createElement('div');
        Alignment.className = 'alignment';
        var Div = document.createElement('div');
        var Itag = document.createElement('i');
        Itag.className = 'bx bx-list-ul list';
        var H5 = document.createElement('h5');
        H5.innerText = task;
        var Input = document.createElement('input');
        Input.className = element.todayTask.indicator[index];
        if(element.todayTask.indicator[index] === 'indicators-approved'){
            Input.value = 'Approved'
        }
        else if(element.todayTask.indicator[index] === 'indicators-inprogress'){
            Input.value = 'In-Progress'
        }
        else{
            Input.value = 'In-Progress'
        }
        Input.type = 'button';
        Div.appendChild(Itag);
        Div.appendChild(H5);
        Alignment.appendChild(Div);
        Alignment.appendChild(Input);
        TodayTask.appendChild(Alignment);
                })
            }
            else{
            }
        })
        }
    }



    </script>
  <script src="script.js"></script>
</body>
</html>